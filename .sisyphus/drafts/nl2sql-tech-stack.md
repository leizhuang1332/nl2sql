# NL2SQL 智能问数项目 - 技术选型清单

## 技术栈汇总

| 层级 | 技术选型 | 说明 |
|------|----------|------|
| **大模型 API** | OpenAI API / OpenRouter | 需调用云端 API |
| **后端** | Python + FastAPI | AI 领域首选，高性能 |
| **数据库连接** | SQLAlchemy | 支持 MySQL/PostgreSQL/Oracle |
| **LLM 框架** | LangChain | 构建 NL2SQL 核心能力 |
| **前端** | React + TypeScript | 主流前端框架 |
| **认证** | 无需认证 | 内网工具，通过审计追踪 |
| **部署** | Docker Compose | 私有化部署首选 |

---

## 推荐架构图

```
┌─────────────────────────────────────────────────────────────┐
│                        用户端                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   React     │  │   Vue       │  │   移动端    │        │
│  │   前端      │  │   前端      │  │   H5        │        │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘        │
└─────────┼───────────────┼────────────────┼────────────────┘
          │               │                │
          ▼               ▼                ▼
┌─────────────────────────────────────────────────────────────┐
│                      API 网关层                             │
│                   (FastAPI + Nginx)                         │
└──────────────────────────┬──────────────────────────────────┘
                           │
         ┌─────────────────┼─────────────────┐
         ▼                 ▼                 ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│   用户服务       │ │  NL2SQL 服务    │ │  审计服务       │
│   (User)        │ │  (NL2SQL Core)  │ │  (Audit)        │
│                 │ │                 │ │                 │
│  - 用户管理     │ │  - LangChain    │ │  - 查询日志     │
│  - 会话管理     │ │  - SQL 生成     │ │  - 脱敏处理     │
└────────┬────────┘ └────────┬────────┘ └────────┬────────┘
         │                   │                   │
         └───────────────────┼───────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────┐
│                     数据库连接层                            │
│              (SQLAlchemy + 数据库方言)                     │
└──────────────────────────┬──────────────────────────────────┘
                           │
         ┌─────────────────┼─────────────────┐
         ▼                 ▼                 ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│     MySQL       │ │  PostgreSQL    │ │     Oracle      │
│                 │ │                 │ │                 │
└─────────────────┘ └─────────────────┘ └─────────────────┘


┌─────────────────────────────────────────────────────────────┐
│                      外部服务                               │
│         ┌─────────────────────────────────┐                │
│         │     大模型 API (OpenAI)         │                │
│         │     (通过 OpenRouter 调用)      │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

---

## 核心技术组件

| 组件 | 技术选型 | 版本建议 |
|------|----------|----------|
| Web 框架 | FastAPI | ≥ 0.100 |
| LLM 框架 | LangChain | ≥ 0.3 |
| 数据库 ORM | SQLAlchemy | ≥ 2.0 |
| 异步客户端 | httpx | ≥ 0.27 |
| 前端框架 | React | ≥ 18 |
| UI 组件库 | Ant Design / Shadcn | 最新 |
| 容器化 | Docker + Compose | 最新 |

---

## 项目目录结构建议

```
nl2sql/
├── frontend/                 # 前端项目
│   ├── src/
│   │   ├── components/      # 组件
│   │   ├── pages/           # 页面
│   │   ├── services/        # API 调用
│   │   └── utils/           # 工具函数
│   └── package.json
│
├── backend/                  # 后端项目
│   ├── app/
│   │   ├── api/            # API 路由
│   │   ├── core/           # 核心配置
│   │   ├── models/         # 数据模型
│   │   ├── services/       # 业务逻辑
│   │   └── utils/          # 工具函数
│   ├── requirements.txt
│   └── main.py
│
├── docker-compose.yml       # 部署配置
└── README.md
```

---

*技术选型完成时间：2026-02-14*
