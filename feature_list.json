{
  "project": "nl2sql",
  "description": "一个基于 Langchain 的 nl2sql 项目",
  "tasks": [
    {
      "id": 1,
      "title": "项目初始化",
      "description": "项目初始化",
      "source": null,
      "priority": "p0",
      "steps": [
        "创建feature_list.json",
        "创建init.sh",
        "创建progress.md",
        "创建AGENTS.md"
      ],
      "files": [],
      "passes": true
    },
    {
      "id": 2,
      "title": "Phase 1: Schema 核心基础",
      "description": "实现 SQLite 数据库连接 + 基本 Schema 提取",
      "source": null,
      "priority": "p0",
      "module": "schema",
      "phase": 1,
      "steps": [
        "实现 DatabaseConnector（仅 SQLite）",
        "实现 SchemaExtractor 基本提取",
        "添加单元测试"
      ],
      "files": [
        "src/schema/database_connector.py",
        "src/schema/schema_extractor.py",
        "tests/test_schema_phase1.py"
      ],
      "passes": true
    },
    {
      "id": 3,
      "title": "Phase 2: Schema 文档生成",
      "description": "生成 LLM 可读的 Schema 文档 + 采样数据",
      "source": null,
      "priority": "p1",
      "module": "schema",
      "phase": 2,
      "steps": [
        "实现 SchemaDocGenerator",
        "添加采样数据功能",
        "添加单元测试"
      ],
      "files": [
        "src/schema/schema_doc_generator.py",
        "src/schema/schema_extractor.py",
        "tests/test_schema_phase2.py"
      ],
      "passes": true
    },
    {
      "id": 4,
      "title": "Phase 3: 语义增强",
      "description": "字段注释/业务含义注入，解决语义歧义",
      "source": null,
      "priority": "p1",
      "module": "schema",
      "phase": 3,
      "steps": [
        "实现 SchemaEnhancer",
        "实现配置文件加载",
        "创建字段描述配置模板",
        "添加单元测试"
      ],
      "files": [
        "src/schema/schema_enhancer.py",
        "config/field_descriptions.json",
        "tests/test_schema_phase3.py"
      ],
      "passes": true
    },
    {
      "id": 5,
      "title": "Phase 4: 关系提取",
      "description": "提取表之间的主键外键关系",
      "source": null,
      "priority": "p2",
      "module": "schema",
      "phase": 4,
      "steps": [
        "实现 RelationshipExtractor",
        "支持手动配置关系",
        "添加单元测试"
      ],
      "files": [
        "src/schema/relationship_extractor.py",
        "tests/test_schema_phase4.py"
      ],
      "passes": true
    },
    {
      "id": 6,
      "title": "Phase 5: 多数据源支持",
      "description": "支持 MySQL/PostgreSQL/Oracle，扩展为工厂模式",
      "source": null,
      "priority": "p5",
      "module": "schema",
      "phase": 5,
      "steps": [
        "扩展 DatabaseConnector 支持多类型",
        "实现 DatabaseConnectorFactory",
        "预留扩展接口",
        "添加单元测试"
      ],
      "files": [
        "src/schema/database_connector.py",
        "tests/test_schema_phase5.py"
      ],
      "passes": true
    },
    {
      "id": 7,
      "title": "Generation Phase 1: LLM工厂 + SQL生成器",
      "description": "实现 LLM 工厂 (支持 MiniMax M2.5) 和 SQL 生成器基础功能",
      "source": "docs/core-modules-2-phases.md",
      "priority": "p0",
      "module": "generation",
      "phase": 1,
      "steps": [
        "实现 LLMFactory (支持 minimax/openai/anthropic/ollama/custom)",
        "实现 SQLGenerator 基础功能",
        "添加单元测试"
      ],
      "files": [
        "src/generation/llm_factory.py",
        "src/generation/sql_generator.py",
        "tests/test_generation_phase1.py"
      ],
      "passes": true
    },
    {
      "id": 8,
      "title": "Generation Phase 2: Few-shot管理 + Prompt模板",
      "description": "实现 Few-shot 示例管理和多种 Prompt 模板",
      "source": "docs/core-modules-2-phases.md",
      "priority": "p1",
      "module": "generation",
      "phase": 2,
      "steps": [
        "实现 FewShotManager 示例管理",
        "实现 prompts.py 模板集合",
        "添加单元测试"
      ],
      "files": [
        "src/generation/few_shot_manager.py",
        "src/generation/prompts.py",
        "tests/test_generation_phase2.py"
      ],
      "passes": true
    },
    {
      "id": 9,
      "title": "Generation Phase 3: SQL验证器",
      "description": "实现 SQL 验证功能，防止危险操作",
      "source": "docs/core-modules-2-phases.md",
      "priority": "p2",
      "module": "generation",
      "phase": 3,
      "steps": [
        "实现 SQLValidator 验证功能",
        "添加单元测试"
      ],
      "files": [
        "src/generation/sql_validator.py",
        "tests/test_generation_phase3.py"
      ],
      "passes": true
    },
    {
      "id": 10,
      "title": "Execution Phase 1: 查询执行器 + 结果处理",
      "description": "实现 QueryExecutor 查询执行器和 ResultHandler 结果处理器",
      "source": "docs/core-modules-3.md",
      "priority": "p0",
      "module": "execution",
      "phase": 1,
      "steps": [
        "实现 QueryExecutor 基础执行",
        "实现错误捕获与重试逻辑",
        "实现 ResultHandler 结果处理",
        "添加单元测试"
      ],
      "files": [
        "src/execution/query_executor.py",
        "src/execution/result_handler.py",
        "tests/test_execution_phase1.py"
      ],
      "passes": true
    },
    {
      "id": 11,
      "title": "Execution Phase 2: 错误分析 + 重试策略",
      "description": "实现 ErrorAnalyzer 错误分析和 RetryConfig 重试策略",
      "source": "docs/core-modules-3.md",
      "priority": "p1",
      "module": "execution",
      "phase": 2,
      "steps": [
        "实现 ErrorAnalyzer 错误分析",
        "实现 RetryConfig 重试策略",
        "添加单元测试"
      ],
      "files": [
        "src/execution/error_analyzer.py",
        "tests/test_execution_phase2.py"
      ],
      "passes": true
    },
    {
      "id": 12,
      "title": "Execution Phase 3: 查询监控",
      "description": "实现 QueryMonitor 查询监控和慢查询检测",
      "source": "docs/core-modules-3.md",
      "priority": "p2",
      "module": "execution",
      "phase": 3,
      "steps": [
        "实现 QueryMonitor 查询监控",
        "实现慢查询检测",
        "添加单元测试"
      ],
      "files": [
        "src/execution/query_monitor.py",
        "tests/test_execution_phase3.py"
      ],
      "passes": false
    },
    {
      "id": 13,
      "title": "Semantic Phase 1: 核心映射功能",
      "description": "实现 SemanticMapper、TimeParser、ConfigManager 核心映射功能",
      "source": "docs/core-modules-4-phases.md",
      "priority": "p0",
      "module": "semantic",
      "phase": 1,
      "steps": [
        "实现 SemanticMapper 语义映射器",
        "实现 TimeParser 时间表达式解析",
        "实现 SemanticConfigManager 配置管理",
        "创建配置文件模板",
        "添加单元测试"
      ],
      "files": [
        "src/semantic/semantic_mapper.py",
        "src/semantic/time_parser.py",
        "src/semantic/config_manager.py",
        "config/semantic_mappings.json",
        "tests/test_semantic_phase1.py"
      ],
      "passes": false
    },
    {
      "id": 14,
      "title": "Semantic Phase 2: 向量语义匹配",
      "description": "实现 VectorMatcher 向量语义匹配功能",
      "source": "docs/core-modules-4-phases.md",
      "priority": "p1",
      "module": "semantic",
      "phase": 2,
      "steps": [
        "实现 VectorMatcher 向量匹配",
        "实现余弦相似度计算",
        "添加单元测试"
      ],
      "files": [
        "src/semantic/vector_matcher.py",
        "tests/test_semantic_phase2.py"
      ],
      "passes": false
    },
    {
      "id": 15,
      "title": "Semantic Phase 3: 上下文感知映射",
      "description": "实现 ContextAwareMapper 上下文感知字段消解",
      "source": "docs/core-modules-4-phases.md",
      "priority": "p1",
      "module": "semantic",
      "phase": 3,
      "steps": [
        "实现 ContextAwareMapper 上下文感知",
        "实现字段歧义消解",
        "添加单元测试"
      ],
      "files": [
        "src/semantic/context_aware_mapper.py",
        "tests/test_semantic_phase3.py"
      ],
      "passes": false
    }
  ]
}
